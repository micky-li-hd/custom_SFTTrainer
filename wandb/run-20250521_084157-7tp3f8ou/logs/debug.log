2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_setup.py:_flush():70] Current SDK version is 0.19.11
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_setup.py:_flush():70] Configure stats pid to 3183294
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_setup.py:_flush():70] Loading settings from /home/v-haodongli/.config/wandb/settings
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_setup.py:_flush():70] Loading settings from /home/v-haodongli/t2isft/wandb/settings
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_setup.py:_flush():70] Loading settings from environment variables
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /home/v-haodongli/t2isft/wandb/run-20250521_084157-7tp3f8ou/logs/debug.log
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /home/v-haodongli/t2isft/wandb/run-20250521_084157-7tp3f8ou/logs/debug-internal.log
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_init.py:init():852] calling init triggers
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_init.py:init():893] starting backend
2025-05-21 08:41:57,295 INFO    MainThread:3183294 [wandb_init.py:init():897] sending inform_init request
2025-05-21 08:41:57,298 INFO    MainThread:3183294 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-21 08:41:57,298 INFO    MainThread:3183294 [wandb_init.py:init():907] backend started and connected
2025-05-21 08:41:57,299 INFO    MainThread:3183294 [wandb_init.py:init():1005] updated telemetry
2025-05-21 08:41:57,303 INFO    MainThread:3183294 [wandb_init.py:init():1029] communicating run to backend with 90.0 second timeout
2025-05-21 08:41:57,614 INFO    MainThread:3183294 [wandb_init.py:init():1104] starting run threads in backend
2025-05-21 08:41:57,705 INFO    MainThread:3183294 [wandb_run.py:_console_start():2573] atexit reg
2025-05-21 08:41:57,705 INFO    MainThread:3183294 [wandb_run.py:_redirect():2421] redirect: wrap_raw
2025-05-21 08:41:57,705 INFO    MainThread:3183294 [wandb_run.py:_redirect():2490] Wrapping output streams.
2025-05-21 08:41:57,705 INFO    MainThread:3183294 [wandb_run.py:_redirect():2513] Redirects installed.
2025-05-21 08:41:57,707 INFO    MainThread:3183294 [wandb_init.py:init():1150] run started, returning control to user process
2025-05-21 08:41:57,708 INFO    MainThread:3183294 [wandb_run.py:_config_callback():1436] config_cb None None {'wandb.entity': None, 'wandb.resume': 'auto', 'wandb.run_id': '7tp3f8ou', 'experiment.project': 'janus-SFT', 'experiment.name': 'janus-SFT', 'experiment.output_dir': 'janus-SFT', 'experiment.max_train_examples': 20000000, 'experiment.max_train_examples_mmu': 40000000, 'experiment.save_every': 10000, 'experiment.eval_every': 2500, 'experiment.generate_every': 1000, 'experiment.log_every': 50, 'experiment.log_grad_norm_every': 500, 'experiment.logging_dir': 'janus-SFT/logs', 'model.janus_pro.model_name_or_path': 'deepseek-ai/Janus-Pro-7B', 'model.gradient_checkpointing': True, 'dataset.params.path': '/home/v-haodongli/Janus/tmp_script/laion_2b_aesthetic', 'dataset.params.shuffle_buffer_size': 1000, 'dataset.params.max_samples': 1000, 'dataset.params.num_workers': 32, 'dataset.params.resolution': 256, 'dataset.params.pin_memory': True, 'dataset.params.persistent_workers': True, 'dataset.preprocessing.max_seq_length': 381, 'optimizer.name': 'adamw', 'optimizer.params.learning_rate': 2e-05, 'optimizer.params.scale_lr': False, 'optimizer.params.beta1': 0.9, 'optimizer.params.beta2': 0.999, 'optimizer.params.weight_decay': 0.01, 'optimizer.params.epsilon': 1e-08, 'lr_scheduler.scheduler': 'cosine', 'lr_scheduler.params.learning_rate': 2e-05, 'lr_scheduler.params.warmup_steps': 1000, 'training.gradient_accumulation_steps': 1, 'training.noise_type': 'mask', 'training.batch_size': 4, 'training.samples_per_epoch': 10000, 'training.mixed_precision': 'bf16', 'training.enable_tf32': True, 'training.seed': 10086, 'training.max_train_steps': 10000, 'training.overfit_one_batch': False, 'training.cond_dropout_prob': 0.1, 'training.min_masking_rate': 0.0, 'training.label_smoothing': 0.0, 'training.max_grad_norm': None, 'training.guidance_scale': 0.0, 'training.generation_timesteps': 12, 'training.t2i_coeff': 1.0, 'training.lm_coeff': 0.1, 'training.mmu_coeff': 1.0, 'config': 'config/sft.yaml'}
2025-05-21 08:42:10,709 INFO    MsgRouterThr:3183294 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 1 handles.
